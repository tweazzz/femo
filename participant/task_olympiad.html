<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Задача олимпиады</title>
    <link rel="stylesheet" href="/dist/style.css" />

    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/@lucide/web@latest"></script>
    <link rel="icon" href="/src/assets/images/cube.png" type="image/png">
  </head>
<style>
  /* скрывает до тех пор, пока JS не снимет класс */
  .preload-hidden { display: none !important; }
  #pag-tasks {
  margin-top: 100px;
  padding: 20px;
  max-width: 68%;
}

@media screen and (max-width: 1279px) {
  #pag-tasks {
    max-width: 100%;
  }
}

</style>
<style>
  /* ===== PAGINATION ===== */
  #pagination {
    display: flex;
    gap: 12px;
  }
  
  .page-btn {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    border: 1px solid #EFEFEF;
    background: transparent;
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .page-btn.active {
    background-color: #FEF1E4;
    border-color: #F4891E;
    color: #F4891E;
  }
  
  /* ===== TASK BUTTONS ===== */
  .task-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px 20px;
    width: 164px;
    height: 40px;
    border-radius: 8px;
    border: 2px solid #EFEFEF;
    cursor: pointer;
  }
  
  .task-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  </style>
  <body>
    <div class="flex h-screen">
      <!-- Sidebar -->
      <aside id="sidebar" class="sidebar">
        <div class="mb-10 px-6 py-7">
          <img src="/src/assets/images/logo.png" alt="Logo" class="h-5" />
        </div>

        <nav class="flex-1 px-4">
          <a href="/participant/dashboard.html" class="sidebar-link" data-i18n="dashboard.nav_index">
            <img src="/src/assets/images/index_noactive.svg" alt="Главная" class="mr-3 size-6" />
            Главная
          </a>
          <a href="/participant/olympiads.html" class="sidebar-link active" data-i18n="dashboard.nav_olympiads">
            <img src="/src/assets/images/olympiad_active.svg" alt="Олимпиады" class="mr-3 size-6" />
            Олимпиады
          </a>
          <a href="/participant/tasks.html" class="sidebar-link" data-i18n="dashboard.nav_tasks">
            <img src="/src/assets/images/task_noactive.svg" alt="Задачи" class="mr-3 size-6" />
            Задачи
          </a>
          <a href="/participant/certificates.html" class="sidebar-link" data-i18n="dashboard.nav_certificates">
            <img src="/src/assets/images/certificate_noactive.svg" alt="Сертификаты" class="mr-3 size-6" />
            Сертификаты
          </a>
          <a href="/participant/rate-overall.html" class="sidebar-link" data-i18n="dashboard.nav_ratings">
            <img src="/src/assets/images/ranking_noactive.svg" alt="Рейтинг" class="mr-3 size-6" />
            Рейтинг
          </a>
          <a href="/participant/payments.html" class="sidebar-link">
            <img src="/src/assets/images/balance_noactive.svg" alt="Баланс и платежи" class="mr-3 size-6" />
            <span data-i18n="dashboard.nav_payments">Баланс и платежи</span>
          </a>
        </nav>

        <div class="p-4">
          <a href="/participant/my-way.html" class="sidebar-link">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="mr-3 size-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
              />
            </svg>

            <span data-i18n="dashboard.profile">Профиль</span>
          </a>
          <a href="/" class="sidebar-link flex items-center gap-2">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.41699 6.29995C7.67533 3.29995 9.21699 2.07495 12.592 2.07495H12.7003C16.4253 2.07495 17.917 3.56662 17.917 7.29162V12.725C17.917 16.45 16.4253 17.9416 12.7003 17.9416H12.592C9.24199 17.9416 7.70033 16.7333 7.42533 13.7833" stroke="#222222" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M12.5002 10H3.01685" stroke="#222222" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M4.87467 7.20825L2.08301 9.99992L4.87467 12.7916" stroke="#222222" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
              <span data-i18n="dashboard.logout">Выйти из аккаунта</span>
            </a>
        </div>
      </aside>

      <!-- Overlay -->
      <div
        id="overlay"
        class="fixed inset-0 z-10 hidden cursor-pointer bg-black/50 transition lg:hidden"
        onclick="toggleSidebar()"
      ></div>

      <!-- Main Content -->
      <div class="flex flex-1 flex-col overflow-hidden">
        <!-- Top Bar -->
        <header class="border-gray-border border-b bg-white">
          <div class="flex items-center justify-between px-6 py-4">
            <div class="flex items-center">
              <button
                class="mr-4 cursor-pointer text-gray-600 hover:text-gray-900 lg:hidden"
                onclick="toggleSidebar()"
              >
                <i data-lucide="menu" class="h-6 w-6"></i>
              </button>
              <h1 class="text-xl max-md:hidden"></h1>
            </div>

            <div class="flex items-center gap-6">
              <!-- MY BALANCE -->
              <div class="balance-card">
                <span class="balance-label" data-i18n="dashboard.balance">Баланс:</span>
                <span class="balance">0 ₸</span>
              </div>


              <!-- DROPDOWN -->
              <div class="relative inline-block text-left" id="lang-dropdown">
                <!-- Кнопка -->
                <button
                  type="button"
                  id="lang-dropdown-btn"
                  class="flex items-center justify-between w-[85px] h-[23px] px-2 rounded-md border-gray-300 bg-white"
                >
                  <div class="flex items-center gap-2">
                    <img id="lang-flag" src="https://flagcdn.com/w24/ru.png" class="w-6 h-[17px] object-contain" />
                    <span id="lang-text" class="text-[12px] font-medium">RU</span>
                  </div>

                  <!-- стрелочка -->
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 10L12.0008 14.58L17 10" stroke="#0A090B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>

                <!-- Выпадающий список -->
                <div
                  id="lang-menu"
                  class="absolute z-20 mt-1 w-[120px] bg-white border border-gray-200 rounded-md shadow-md hidden"
                >
                  <!-- RU -->
                  <div data-lang="ru"
                    class="lang-option flex items-center gap-2 px-2 py-1 cursor-pointer hover:bg-gray-100">
                    <img src="https://flagcdn.com/w40/ru.png" class="w-6 h-[17px] object-contain" />
                    <span class="text-sm">RU</span>
                  </div>

                  <!-- KZ -->
                  <div data-lang="kz"
                    class="lang-option flex items-center gap-2 px-2 py-1 cursor-pointer hover:bg-gray-100">
                    <img src="https://flagcdn.com/w40/kz.png" class="w-6 h-[17px] object-contain" />
                    <span class="text-sm">KZ</span>
                  </div>

                  <!-- EN -->
                  <div data-lang="en"
                    class="lang-option flex items-center gap-2 px-2 py-1 cursor-pointer hover:bg-gray-100">
                    <img src="https://flagcdn.com/w40/gb.png" class="w-6 h-[17px] object-contain" />
                    <span class="text-sm">EN</span>
                  </div>
                </div>
              </div>


              <div class="flex items-center space-x-4">
                <button
                  type="button"
                  onclick="toggleModal('modalNotification')"
                  class="text-orange-primary bg-orange-secondary cursor-pointer rounded-full p-1"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="size-6"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"
                    />
                  </svg>
                </button>
                <div class="flex items-center space-x-3">
                  <img
                    id="user-avatar"
                    src=""
                    alt="Profile"
                    class="h-10 w-10 rounded-full"
                  />
                  <div>
                    <p id="user-name" class="font-bold"></p>
                    <p id="user-role" class="text-primary text-sm"></p>
                  </div>
                </div>
              </div>
          </div>
          </div>
        </header>

        <!-- Content Area -->
        <main class="space-y-6 overflow-y-auto p-6">
          <!-- Breadcrumbs -->
          <div class="pt-2 text-sm">
            <nav class="flex items-center space-x-1">
              <a href="/participant/olympiads.html" class="text-gray-primary hover:underline" data-i18n="dashboard.nav_olympiads">Олимпиады</a>

              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="size-5"
              >
                <path
                  fill-rule="evenodd"
                  d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z"
                  clip-rule="evenodd"
                />
              </svg>
              <a id="olympiad_tasks_list" href="#" class="text-orange-primary font-medium">Задачи олимпиады</a>
              
              <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="size-5"
            >
              <path
                fill-rule="evenodd"
                d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z"
                clip-rule="evenodd"
              />
              </svg>

              <span class="text-orange-primary font-medium" id="task-title"
                ></span>
        
            </nav>
          </div>

          <!-- Task Description -->

          <div>
            <h2 id="task-title2" class="mb-1 text-2xl font-semibold"></h2>
            <p id="task-grade" class="text-gray-600"></p>
          </div>

          <div class="grid gap-4 xl:grid-cols-3">
            <div class="xl:col-span-2">
<!-- WIN (по умолчанию скрыт) -->
<div id="win-info" class="card border-default text-green-primary bg-green-secondary mb-4 flex items-center gap-2 rounded-2xl px-4 py-3 preload-hidden" role="status" aria-live="polite">
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M10.0003 18.3334C14.5837 18.3334 18.3337 14.5834 18.3337 10.0001C18.3337 5.41675 14.5837 1.66675 10.0003 1.66675C5.41699 1.66675 1.66699 5.41675 1.66699 10.0001C1.66699 14.5834 5.41699 18.3334 10.0003 18.3334Z" stroke="#0DB459" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
    <path d="M6.45801 9.99993L8.81634 12.3583L13.5413 7.6416" stroke="#0DB459" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
  </svg>
  <span id="win-info-text" style="font-size: 16px; padding: 12px;"><span data-i18n="task.correct_answer">Ты победил(а)! Ответ верный и вовремя — ты получаешь  </span><strong id="win-info-xp"></strong></span>
</div>

<!-- LOSE (по умолчанию скрыт) -->
<div id="lose-info" class="card border-default text-red-primary bg-red-secondary mb-4 flex items-center gap-2 rounded-2xl px-4 py-3 preload-hidden" role="status" aria-live="polite">
  <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M10.0003 18.3334C14.5837 18.3334 18.3337 14.5834 18.3337 10.0001C18.3337 5.41675 14.5837 1.66675 10.0003 1.66675C5.41699 1.66675 1.66699 5.41675 1.66699 10.0001C1.66699 14.5834 5.41699 18.3334 10.0003 18.3334Z" stroke="#E81C2B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
    <path d="M7.64172 12.3584L12.3584 7.64172" stroke="#E81C2B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
    <path d="M12.3584 12.3584L7.64172 7.64172" stroke="#E81C2B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
  </svg>
  <span id="lose-info-text" data-i18n="task.incorrect_answer" style="font-size: 16px; padding: 12px;">Увы, ответ неверный. Попробуйте снова</span>
</div>
               <div class="border-default text-primary mb-6 rounded-lg p-6">
                <h3 class="mb-4 flex items-center gap-2"   style="
    width: 100%;
    height: 62px;
    background-color: #FBFBFB;
    font-family: 'Proxima Nova', sans-serif;
    font-weight: 700;
    font-size: 18px;
    line-height: 124%;
    letter-spacing: 0%;
  ">
                  <span class="text-xl"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16.0083 5.30001C15.1417 3.55001 13.4667 2.25834 11.525 1.83334C9.49168 1.38334 7.40835 1.86668 5.81668 3.15001C4.21668 4.42501 3.30835 6.33334 3.30835 8.37501C3.30835 10.5333 4.60002 12.7917 6.55002 14.1V14.7917C6.54168 15.025 6.53335 15.3833 6.81668 15.675C7.10835 15.975 7.54168 16.0083 7.88335 16.0083H12.1583C12.6083 16.0083 12.95 15.8833 13.1833 15.65C13.5 15.325 13.4917 14.9083 13.4833 14.6833V14.1C16.0667 12.3583 17.6917 8.68334 16.0083 5.30001Z" fill="#F4891E"/>
                  <path d="M12.7167 18.3333C12.6667 18.3333 12.6084 18.325 12.5584 18.3083C10.8834 17.8333 9.12505 17.8333 7.45005 18.3083C7.14171 18.3916 6.81671 18.2166 6.73338 17.9083C6.64171 17.6 6.82505 17.275 7.13338 17.1916C9.01671 16.6583 11 16.6583 12.8834 17.1916C13.1917 17.2833 13.375 17.6 13.2834 17.9083C13.2 18.1666 12.9667 18.3333 12.7167 18.3333Z" fill="#F4891E"/>
                  </svg>
                  </span>
                  <span data-i18n="task.form">Условие задачи</span>
                </h3>
                <div class="text border-gray-border mb-5 border-b pb-4">
                  <p id="task-description"></p>
                </div>

                <!-- Download Links -->
                <div id='task-attachments' class="space-y-3">
                </div>
              </div>

              <!-- Answer Section -->
              <label class="mb-4 block">
                <span class="text-gray-primary mb-1 block text-sm font-medium"
                data-i18n="task.your_answer">Ваш ответ</span
                >
                <input
                  id="answer-input"
                  type="text"
                  placeholder="Введите ответ"

                  class="input-base border-default mt-1"
                />
                  <p
                    id="answer-error"
                    class="mt-1 text-red-primary text-sm"
                    style="display: none;"
                  >
              </label>
            </div>


            <!-- Task Details -->
            <div class="space-y-4 xl:col-span-1">
              <div class="border-default rounded-lg p-6">
                <h3 class="mb-6 text-lg font-bold" data-i18n="task.details">Детали задачи</h3>

                <div class="space-y-4">
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-primary" data-i18n="task.language">Язык</span>
                    <span class="text-primary" id="task-language"></span>
                  </div>

                  <div class="space-y-4">
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-primary" data-i18n="task.autor">Автор задачи</span>
                    <span class="text-primary"
                      ></span
                    >
                  </div>

                <div class="space-y-4">
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-primary" data-i18n="task.deadline_do">Сдать до</span>
                    <span class="text-primary"
                      ></span
                    >
                  </div>

                  <div class="flex items-center justify-between text-sm">
                    <span class="text-sm text-gray-500" data-i18n="task.deadline_ostalos">Осталось времени</span>
                    <div
                      class="timer flex items-center gap-1 text-center text-sm font-bold text-orange-500"
                    >
                    </div>
                  </div>

                  <div class="flex items-center justify-between">
                    <span class="text-gray-primary text-sm"
                    data-i18n="task.level">Уровень сложности</span
                    >
                    <span id="task-level" class="d-level easy"></span>
                  </div>

                  <div class="flex items-center justify-between">
                    <span class="text-gray-primary text-sm"
                    data-i18n="task.bonus_for_correct_ans">За правильный ответ:
                    </span>
                    <span id="task-points" class=""></span>
                  </div>

                  <div class="flex items-center justify-between">
                    <span class="text-gray-primary text-sm" data-i18n="task.status">Статус</span>
                    <span id="task-status" class="card archive"></span>
                  </div>
                </div>
              </div>

              <div class="space-y-4">
                <button
                  id="submit-button1"
                  class="bg-orange-primary hover:bg-orange-primary/90 flex w-full cursor-pointer items-center justify-center gap-1 rounded-lg px-4 py-2 text-white transition-colors"
                  hidden>
                  <span>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="size-5"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"
                      />
                    </svg>
                  </span>
                  <span data-i18n="task.answer_btn">Отправить ответ</span>
                </button>

                <button
                  id="clear-button"
                  class="text-orange-primary border-orange-primary flex w-full cursor-pointer items-center justify-center gap-1 rounded-lg border-1 px-4 py-2 transition-colors"
                  hidden>
                  <span data-i18n="task.answer_clear">Очистить ответ</span>
                </button>

                <button
                  id="submit-button2"
                  class="bg-gray-background text-gray-primary hover:bg-gray-primary/5 flex w-full cursor-pointer items-center justify-center gap-1 rounded-lg px-4 py-2 transition-colors"
                  hidden>
                  <span>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="size-5"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"
                      />
                    </svg>
                  </span>
                  <span data-i18n="task.answer_btn">Отправить ответ</span>
                </button>
                <a href="/participant/tasks.html" id="next-task-button2" class="bg-orange-primary flex w-full cursor-pointer items-center justify-center gap-1 rounded-xl p-2.5 text-white preload-hidden">
                        <span>
                        <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.992 1.66675H7.00866C3.97533 1.66675 2.16699 3.47508 2.16699 6.50841V13.4917C2.16699 16.5251 3.97533 18.3334 7.00866 18.3334H13.992C17.0253 18.3334 18.8337 16.5251 18.8337 13.4917V6.50841C18.8337 3.47508 17.0253 1.66675 13.992 1.66675ZM8.80866 12.4167L6.93366 14.2917C6.80866 14.4167 6.65033 14.4751 6.49199 14.4751C6.33366 14.4751 6.16699 14.4167 6.05033 14.2917L5.42533 13.6667C5.17533 13.4251 5.17533 13.0251 5.42533 12.7834C5.66699 12.5417 6.05866 12.5417 6.30866 12.7834L6.49199 12.9667L7.92533 11.5334C8.16699 11.2917 8.55866 11.2917 8.80866 11.5334C9.05033 11.7751 9.05033 12.1751 8.80866 12.4167ZM8.80866 6.58341L6.93366 8.45841C6.80866 8.58341 6.65033 8.64175 6.49199 8.64175C6.33366 8.64175 6.16699 8.58341 6.05033 8.45841L5.42533 7.83341C5.17533 7.59175 5.17533 7.19175 5.42533 6.95008C5.66699 6.70841 6.05866 6.70841 6.30866 6.95008L6.49199 7.13341L7.92533 5.70008C8.16699 5.45841 8.55866 5.45841 8.80866 5.70008C9.05033 5.94175 9.05033 6.34175 8.80866 6.58341ZM15.1337 13.8501H10.7587C10.417 13.8501 10.1337 13.5667 10.1337 13.2251C10.1337 12.8834 10.417 12.6001 10.7587 12.6001H15.1337C15.4837 12.6001 15.7587 12.8834 15.7587 13.2251C15.7587 13.5667 15.4837 13.8501 15.1337 13.8501ZM15.1337 8.01675H10.7587C10.417 8.01675 10.1337 7.73341 10.1337 7.39175C10.1337 7.05008 10.417 6.76675 10.7587 6.76675H15.1337C15.4837 6.76675 15.7587 7.05008 15.7587 7.39175C15.7587 7.73341 15.4837 8.01675 15.1337 8.01675Z" fill="white"></path>
                        </svg>

                        </span>
                        <span data-i18n="task.next_task_btn">Перейти к следующей задаче</span>
                </a>
                <div
                  id="modal"
                  class="modal fixed top-1/2 z-30 hidden max-w-md -translate-y-1/2 max-sm:inset-x-4 sm:left-1/2 sm:w-full sm:-translate-x-1/2"
                >
                  <div class="relative">
                    <div
                      class="flex flex-col items-center space-y-6 rounded-3xl bg-white p-5 pt-10 text-base"
                    >
                      <img
                        src="/src/assets/images/celebrate.png"
                        alt="celebrate"
                      />
                      <div>
                        <p class="text-2xl font-bold text-center">Миссия выполнена</p>
                        <p id="modal-xp"  class="mt-1 text-sm">
                          Ответ верный и вовремя — ты получаешь +XX XP
                        </p>
                      </div>

                      <a
                        id="next-task-button"
                        class="bg-orange-primary flex w-full cursor-pointer items-center justify-center gap-1 rounded-xl p-2.5 text-white"
                      >
                        <span>
                        <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.992 1.66675H7.00866C3.97533 1.66675 2.16699 3.47508 2.16699 6.50841V13.4917C2.16699 16.5251 3.97533 18.3334 7.00866 18.3334H13.992C17.0253 18.3334 18.8337 16.5251 18.8337 13.4917V6.50841C18.8337 3.47508 17.0253 1.66675 13.992 1.66675ZM8.80866 12.4167L6.93366 14.2917C6.80866 14.4167 6.65033 14.4751 6.49199 14.4751C6.33366 14.4751 6.16699 14.4167 6.05033 14.2917L5.42533 13.6667C5.17533 13.4251 5.17533 13.0251 5.42533 12.7834C5.66699 12.5417 6.05866 12.5417 6.30866 12.7834L6.49199 12.9667L7.92533 11.5334C8.16699 11.2917 8.55866 11.2917 8.80866 11.5334C9.05033 11.7751 9.05033 12.1751 8.80866 12.4167ZM8.80866 6.58341L6.93366 8.45841C6.80866 8.58341 6.65033 8.64175 6.49199 8.64175C6.33366 8.64175 6.16699 8.58341 6.05033 8.45841L5.42533 7.83341C5.17533 7.59175 5.17533 7.19175 5.42533 6.95008C5.66699 6.70841 6.05866 6.70841 6.30866 6.95008L6.49199 7.13341L7.92533 5.70008C8.16699 5.45841 8.55866 5.45841 8.80866 5.70008C9.05033 5.94175 9.05033 6.34175 8.80866 6.58341ZM15.1337 13.8501H10.7587C10.417 13.8501 10.1337 13.5667 10.1337 13.2251C10.1337 12.8834 10.417 12.6001 10.7587 12.6001H15.1337C15.4837 12.6001 15.7587 12.8834 15.7587 13.2251C15.7587 13.5667 15.4837 13.8501 15.1337 13.8501ZM15.1337 8.01675H10.7587C10.417 8.01675 10.1337 7.73341 10.1337 7.39175C10.1337 7.05008 10.417 6.76675 10.7587 6.76675H15.1337C15.4837 6.76675 15.7587 7.05008 15.7587 7.39175C15.7587 7.73341 15.4837 8.01675 15.1337 8.01675Z" fill="white"/>
                        </svg>

                        </span>
                        Перейти к следующей задаче
                      </a>
                    </div>

                    <button
                      class="absolute top-5 right-5 cursor-pointer"
                      type="button"
                      onclick="toggleModal('modal')"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        class="size-6"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z"
                          clip-rule="evenodd"
                        />
                      </svg>
                    </button>
                  </div>
                </div>

                <div
                id="modalNotification"
                class="modal fixed top-18 z-30 hidden max-w-lg max-sm:inset-x-4 sm:right-10 sm:w-full"
              >
                <div class="relative">
                  <div
                    class="flex flex-col space-y-4 rounded-3xl bg-white p-4 pt-6 text-base"
                  >
                    <p class="text-xl font-bold" data-i18n="notification.nots-popup">Уведомление</p>

                    <div class="tabs !mb-4 justify-between overflow-x-auto gap-2">
                      <div
                        class="tabs-link active flex cursor-pointer items-center gap-1 px-4 py-4"
                        data-tab="all"
                      >
                        <span>
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="size-5"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"
                            />
                          </svg>
                        </span>
                        <span data-i18n="notification.all">Все</span>
                        <span class="count-msg">4</span>
                      </div>
                      <div
                        class="tabs-link flex cursor-pointer items-center gap-1 px-4 py-4"
                        data-tab="olympiads"
                      >
                        <span>
                        <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.66602 2.16675V4.66675" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M13.334 2.16675V4.66675" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2.91602 8.07495H17.0827" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M17.5 7.58341V14.6667C17.5 17.1667 16.25 18.8334 13.3333 18.8334H6.66667C3.75 18.8334 2.5 17.1667 2.5 14.6667V7.58341C2.5 5.08341 3.75 3.41675 6.66667 3.41675H13.3333C16.25 3.41675 17.5 5.08341 17.5 7.58341Z" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M13.0781 11.9167H13.0856" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M13.0781 14.4167H13.0856" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9.99607 11.9167H10.0036" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9.99607 14.4167H10.0036" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M6.91209 11.9167H6.91957" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M6.91209 14.4167H6.91957" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>

                        </span>
                        <span data-i18n="notification.olympiads">Олимпиады</span>
                        <span class="count-msg">0</span>
                      </div>
                      <div
                        class="tabs-link flex cursor-pointer items-center gap-1 px-4 py-4"
                        data-tab="tasks"
                      >
                        <span>
                        <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.3086 7.8999H14.6836" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5.31641 7.8999L5.94141 8.5249L7.81641 6.6499" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10.3086 13.7334H14.6836" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5.31641 13.7334L5.94141 14.3584L7.81641 12.4834" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7.49935 18.8334H12.4993C16.666 18.8334 18.3327 17.1667 18.3327 13.0001V8.00008C18.3327 3.83341 16.666 2.16675 12.4993 2.16675H7.49935C3.33268 2.16675 1.66602 3.83341 1.66602 8.00008V13.0001C1.66602 17.1667 3.33268 18.8334 7.49935 18.8334Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>

                        </span>
                        <span data-i18n="notification.tasks">Задачи</span>
                        <span class="count-msg">1</span>
                      </div>
                      <div
                        class="tabs-link flex cursor-pointer items-center gap-1 px-4 py-4"
                        data-tab="profile"
                      >
                        <span>
                        <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.1341 9.55841C10.0508 9.55008 9.95078 9.55008 9.85911 9.55841C7.87578 9.49175 6.30078 7.86675 6.30078 5.86675C6.30078 3.82508 7.95078 2.16675 10.0008 2.16675C12.0424 2.16675 13.7008 3.82508 13.7008 5.86675C13.6924 7.86675 12.1174 9.49175 10.1341 9.55841Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5.96758 12.6333C3.95091 13.9833 3.95091 16.1833 5.96758 17.5249C8.25924 19.0583 12.0176 19.0583 14.3092 17.5249C16.3259 16.1749 16.3259 13.9749 14.3092 12.6333C12.0259 11.1083 8.26758 11.1083 5.96758 12.6333Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>


                        </span>
                        <span data-i18n="notification.profile">Профиль</span>
                        <span class="count-msg">2</span>
                      </div>
                      <div
                      class="tabs-link flex cursor-pointer items-center gap-1 px-4 py-4"
                      data-tab="payments"
                    >
                      <span>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M1.66699 7.0874H18.3337" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                          <path d="M5 13.7541H6.66667" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                          <path d="M8.75 13.7541H12.0833" stroke="currentColor" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                          <path d="M5.36699 2.9209H14.6253C17.592 2.9209 18.3337 3.65423 18.3337 6.57923V13.4209C18.3337 16.3459 17.592 17.0792 14.6337 17.0792H5.36699C2.40866 17.0876 1.66699 16.3542 1.66699 13.4292V6.57923C1.66699 3.65423 2.40866 2.9209 5.36699 2.9209Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                          
                      </span>
                      <span data-i18n="notification.payments">Оплата</span>
                      <span class="count-msg">2</span>
                    </div>
                    </div>

                    <div
                      class="tabs-content scrollbar max-h-[70vh] overflow-y-scroll pe-2"
                    >

                    </div>
                  </div>

                  <button
                    class="absolute top-6 right-5 cursor-pointer"
                    onclick="toggleModal('modalNotification')"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                      class="size-5"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                </div>
              </div>
              </div>
            </div>
          </div>
        </main>
        
        <div class="flex justify-between items-center" id="pag-tasks">
          <!-- Кнопка "Предыдущая" -->
          <button id="prevTaskBtn" class="task-btn prevbtn" disabled>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14.668 8L1.33464 8M1.33464 8L7.33464 14M1.33464 8L7.33464 2" stroke="#071E22" stroke-width="1.5"/>
            </svg>
            <span style="margin-left: 8px;">Предыдущая</span>
          </button>
          
        <!-- Пагинация -->
        <div id="pagination" class="flex gap-2">
          <button class="page-btn active">1</button>
          <button class="page-btn">2</button>
          <button class="page-btn">3</button>
        </div>

          
          <!-- Кнопка "Следующая" -->
          <button id="nextTaskBtn" class="task-btn nextbtn">
            <span style="margin-right: 8px;">Следующая</span>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M1.33203 8L14.664 8M14.664 8L8.664 14M14.664 8L8.664 2" stroke="#071E22" stroke-width="1.5"/>
            </svg>
          </button>
        </div>
        
        
        
        
      <div
        id="overlayModal"
        class="overlay fixed inset-0 z-20 hidden bg-black/50 transition"
      ></div>
    </div>

    <script>
      lucide.createIcons()

      function toggleSidebar() {
        const sidebar = document.getElementById('sidebar')
        const overlay = document.getElementById('overlay')
        sidebar.classList.toggle('active')
        overlay.classList.toggle('hidden')
      }

      function toggleModal(modalId, show = null) {
        const modal = document.getElementById(modalId)
        const overlay = document.getElementById('overlayModal')

        // Determine visibility
        const shouldShow =
          show !== null ? show : modal.classList.contains('hidden')

        // Manage overlay
        overlay.classList.toggle('hidden', !shouldShow)

        // Toggle modal
        modal.classList.toggle('hidden', !shouldShow)

        // Close other modals
        document.querySelectorAll('.modal').forEach((m) => {
          if (m.id !== modalId) m.classList.add('hidden')
        })

        // Body scroll control
        document.body.style.overflow = shouldShow ? 'hidden' : 'auto'
      }

      document.addEventListener('DOMContentLoaded', function () {
        const tabs = document.querySelectorAll('.tabs-link')
        const notifications = document.querySelectorAll('.tabs-notification')

        // Add click event listeners to tabs
        tabs.forEach((tab) => {
          tab.addEventListener('click', function () {
            const tabType = this.dataset.tab

            // Remove active class from all tabs
            tabs.forEach((t) => t.classList.remove('active'))

            // Add active class to clicked tab
            this.classList.add('active')

            // Filter notifications
            notifications.forEach((notification) => {
              if (tabType === 'all' || notification.dataset.tab === tabType) {
                notification.style.display = 'flex'
              } else {
                notification.style.display = 'none'
              }
            })
          })
        })
      })
    </script>
    <script src="/src/scripts/i18n.js"></script>
    <script src="/src/scripts/langInit.js"></script>
    <script src="/auth.js" defer></script>
    <script src="/src/participant/notifications.js" defer></script>
    <script src="/src/participant/task_olympiad.js" defer></script>
    <script src="/src/participant/settings.js" defer></script>
    <script>
      async function loadBalance() {
  const token = localStorage.getItem('access_token')
  if (!token) {
    alert('Токен не найден. Пожалуйста, войдите заново.')
    return
  }

  try {
    const response = await authorizedFetch('https://portal.femo.kz/api/payments/participant/dashboard/balance/', {
      headers: {
        Authorization: `Bearer ${token}`
      }
    })

    if (!response.ok) {
      throw new Error(`Ошибка загрузки баланса: ${response.status}`)
    }

    const data = await response.json()
    const balanceEl = document.querySelector('.balance')
    if (balanceEl) {
      balanceEl.textContent = `${data.balance.toLocaleString('ru-RU')} ₸`
    }
  } catch (err) {
    console.error('Ошибка при загрузке баланса:', err)
  }
}
      document.addEventListener("DOMContentLoaded", () => {
        const dropdownBtn = document.getElementById("lang-dropdown-btn");
        const menu = document.getElementById("lang-menu");

        const flagEl = document.getElementById("lang-flag");
        const textEl = document.getElementById("lang-text");

        const langMap = {
          ru: { flag: "https://flagcdn.com/w40/ru.png", label: "RU" },
          kz: { flag: "https://flagcdn.com/w40/kz.png", label: "KZ" },
          en: { flag: "https://flagcdn.com/w40/gb.png", label: "EN" }
        };

        // открыть / закрыть меню
        dropdownBtn.addEventListener("click", () => {
          menu.classList.toggle("hidden");
        });

        // Подсветка выбранного языка
        function highlightSelected(lang) {
          document.querySelectorAll(".lang-option").forEach(opt => {
            opt.classList.toggle("active", opt.dataset.lang === lang);
          });
        }

        // установить язык при загрузке
        const current = localStorage.getItem("lang") || "ru";
        flagEl.src = langMap[current].flag;
        textEl.textContent = langMap[current].label;
        highlightSelected(current);

        // Обработчик выбора языка
        document.querySelectorAll("#lang-menu .lang-option").forEach(opt => {
          opt.addEventListener("click", async () => {
            const lang = opt.dataset.lang;

            // обновляем UI
            flagEl.src = langMap[lang].flag;
            textEl.textContent = langMap[lang].label;
            highlightSelected(lang);
            menu.classList.add("hidden");

            // сохраняем локально
            localStorage.setItem("lang", lang);

            // --- вот важное место ---
            if (typeof updateUserSettings === "function") {
              try {
                // отправляем PATCH на сервер, как в твоей реализации input[name="lang"]
                await updateUserSettings({ language: lang });

                // Триггерим событие для i18n (чтобы фронт обновил тексты и имя пользователя)
                window.dispatchEvent(new Event("i18n:languageChanged"));
              } catch (err) {
                console.error("Ошибка при смене языка через API:", err);
                alert("Не удалось сменить язык. Попробуйте снова.");
              }
            } else {
              console.warn("updateUserSettings не найдена. Язык обновлён только локально");
              location.reload();
            }
          });
        });

        // закрытие при клике вне dropdown
        document.addEventListener("click", (e) => {
          if (!document.getElementById("lang-dropdown").contains(e.target)) {
            menu.classList.add("hidden");
          }
        });
      });

      document.addEventListener("DOMContentLoaded", async () => {
  // ... весь твой код dropdown

  // Загрузка баланса
  await loadBalance();
});

    </script>
    <style>
          .lang-option.active {
      color: var(--color-orange-primary);
      font-weight: 600;
    }

    #lang-menu {
      transition: opacity 0.15s ease, transform 0.15s ease;
    }

    #lang-menu.hidden {
      opacity: 0;
      transform: translateY(-5px);
      pointer-events: none;
    }

    .balance-card {
      width: 128px;
      height: 40px;
      background-color: #FEF6ED;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 10px;
      border-radius: 6px;
      font-family: 'Proxima Nova', sans-serif;
      font-weight: 700;
      font-style: bold;
      font-size: 14px;
      line-height: 100%;
      color: #F4891E;
    }

    .balance-label {
      margin-right: 5px;
    }

    .balance {
      /* Для выравнивания по правому краю */
      white-space: nowrap;
    }


    </style>
    <!-- <script>
      // получаем параметры текущего URL
      const params = new URLSearchParams(window.location.search);

      const lang = params.get('lang');
      const olympId = params.get('olymp_id');

      // если параметры есть — формируем ссылку
      if (lang && olympId) {
        const link = document.getElementById('olympiad_tasks_list');
        link.href = `/participant/list_tasks_olympiad.html?olympiadId=${olympId}&lang=${lang}`;
      }

    </script> -->

  <style>
/* Стили для пагинации */
#pagination {
  display: flex;
  gap: 12px; /* Отступ между кнопками 12px */
}

/* Общие стили для кнопок пагинации */
.page-btn {
  width: 40px; /* Фиксированная ширина 40px */
  height: 40px; /* Фиксированная высота 40px */
  border-radius: 8px; /* Радиус углов 8px */
  border: 1px solid #EFEFEF; /* Бордера для неактивных кнопок */
  background-color: transparent; /* Прозрачный фон по умолчанию */
  padding: 10px 20px; /* Внутренние отступы */
  font-family: "Helvetica Neue", sans-serif; /* Шрифт */
  font-weight: 400; /* Вес шрифта */
  font-size: 16px; /* Размер шрифта */
  color: #222222; /* Цвет текста по умолчанию (темно-серый) */
  cursor: pointer; /* Курсор для кликабельных кнопок */
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

/* Стиль для активной кнопки */
.page-btn.active {
  background-color: #FEF1E4; /* Фон для активной кнопки */
  border-color: #F4891E; /* Бордер для активной кнопки */
  color: #F4891E; /* Цвет текста для активной кнопки */
}

/* Стиль для неактивных кнопок */
.page-btn:not(.active):hover {
  border-color: #F4891E; /* Бордер для неактивной кнопки при наведении */
  color: #F4891E; /* Цвет текста для неактивной кнопки при наведении */
}

/* Для неактивной кнопки просто оставляем стандартный бордер */
.page-btn:not(.active) {
  border-color: #EFEFEF; /* Цвет бордера для неактивных кнопок */
}


    /* Стили для кнопок */
    .task-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px 20px; /* Паддинги сверху/снизу 8px, по бокам 20px */
      width: 164px; /* Ширина 164px */
      height: 40px; /* Высота 40px */
      border-radius: 8px; /* Радиус углов 8px */
      border: 2px solid var(--color-gray-border); /* Граница 1px и цвет #EFEFEF */
      cursor: not-allowed; /* Курсор при неактивной кнопке */
      opacity: 0.6; /* Сделаем кнопку полупрозрачной для неактивного состояния */
    }

    /* Стили для текста */
    .task-btn span {
      font-family: "Helvetica Neue", sans-serif; /* Шрифт */
      font-weight: 400; /* Вес шрифта */
      font-style: normal; /* Обычный стиль */
      font-size: 16px; /* Размер шрифта */
      line-height: 148%; /* Межстрочный интервал */
      letter-spacing: 0%; /* Без межбуквенного расстояния */
      color: #071E22; /* Цвет текста для неактивной кнопки */
    }

    /* Цвет для стрелок */
    .task-btn svg {
      stroke: #071E22; /* Цвет стрелки для неактивной кнопки */
    }

    /* Когда кнопка активна (не disabled) */
    .task-btn:not(:disabled) {
      opacity: 1; /* Убираем полупрозрачность */
      cursor: pointer; /* Курсор для активной кнопки */
    }

    .task-btn:not(:disabled) span {
      color: #222222; /* Цвет текста для активной кнопки */
    }

    .task-btn:not(:disabled) svg {
      stroke: #222222; /* Цвет стрелки для активной кнопки */
    }



  </style>

  <script>
    // Получаем все кнопки пагинации
  const pageButtons = document.querySelectorAll('.page-btn');

  // Добавляем обработчик событий на все кнопки
  pageButtons.forEach(button => {
    button.addEventListener('click', () => {
      // Удаляем класс 'active' с всех кнопок
      pageButtons.forEach(btn => btn.classList.remove('active'));

      // Добавляем класс 'active' на ту кнопку, на которую кликнули
      button.classList.add('active');
    });
  });

  </script>


<script>
  /* ===============================
     GET URL PARAMS
  ================================ */
  const params = new URLSearchParams(window.location.search);
  const olympId = params.get('olymp_id');
  const lang = params.get('lang') || 'ru';
  const taskIdFromUrl = params.get('id');
  
  // если параметры есть — формируем ссылку
  if (lang && olympId) {
    const link = document.getElementById('olympiad_tasks_list');
    link.href = `/participant/list_tasks_olympiad.html?olympiadId=${olympId}&lang=${lang}`;
  }
  if (!olympId) {
    alert('olymp_id не найден в URL');
    throw new Error('olymp_id missing');
  }
  
  /* ===============================
     STATE
  ================================ */
  let all_tasks = [];
  let currentPage = 1;
  const tasksPerPage = 1;
  
  /* ===============================
     ELEMENTS
  ================================ */
  const pagination = document.getElementById('pagination');
  const prevBtn = document.getElementById('prevTaskBtn');
  const nextBtn = document.getElementById('nextTaskBtn');
  
  /* ===============================
     FETCH TASKS
  ================================ */
  async function fetchTasks() {
  try {
    const token = localStorage.getItem('access_token');

    if (!token) {
      console.error('Токен не найден');
      return;
    }

    const response = await fetch(
      `https://portal.femo.kz/api/olympiads/participant/dashboard/${olympId}/assignments/?language=${lang}`,
      {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        }
      }
    );

    if (!response.ok) {
      console.error('Ошибка запроса:', response.status);
      return;
    }

    all_tasks  = await response.json();

    if (!Array.isArray(all_tasks ) || all_tasks .length === 0) {
      alert('Задачи не найдены');
      return;
    }

    if (taskIdFromUrl) {
      const index = all_tasks.findIndex(t => String(t.id) === String(taskIdFromUrl));
      if (index !== -1) {
        currentPage = index + 1;
      }
    }

    initPagination();
  } catch (error) {
    console.error('Ошибка загрузки задач:', error);
  }
}

  /* ===============================
     INIT PAGINATION
  ================================ */
  function initPagination() {
    renderPagination();
    updateControls();
  }
  
  /* ===============================
     RENDER PAGINATION BUTTONS
  ================================ */
  function renderPagination() {
    pagination.innerHTML = '';
  
    const totalPages = Math.ceil(all_tasks.length / tasksPerPage);
  
    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement('button');
      btn.className = 'page-btn';
      btn.textContent = i;
  
      if (i === currentPage) btn.classList.add('active');
  
      btn.addEventListener('click', () => {
        currentPage = i;
        updateControls();
        openTask();
      });
  
      pagination.appendChild(btn);
    }
  }
  
  /* ===============================
     UPDATE CONTROLS
  ================================ */
  function updateControls() {
    const totalPages = Math.ceil(all_tasks.length / tasksPerPage);
  
    document.querySelectorAll('.page-btn').forEach((btn, index) => {
      btn.classList.toggle('active', index + 1 === currentPage);
    });
  
    prevBtn.disabled = currentPage === 1;
    nextBtn.disabled = currentPage === totalPages;
  }
  
  /* ===============================
     OPEN TASK
  ================================ */
  function openTask() {
    const index = (currentPage - 1) * tasksPerPage;
    const task = all_tasks[index];
  
    if (!task) return;
  
    window.location.href =
      `/participant/task_olympiad.html?id=${task.id}&lang=${lang}&olymp_id=${olympId}`;
  }
  
  /* ===============================
     BUTTON EVENTS
  ================================ */
  prevBtn.addEventListener('click', () => {
    if (currentPage > 1) {
      currentPage--;
      updateControls();
      openTask();
    }
  });
  
  nextBtn.addEventListener('click', () => {
    const totalPages = Math.ceil(all_tasks.length / tasksPerPage);
    if (currentPage < totalPages) {
      currentPage++;
      updateControls();
      openTask();
    }
  });
  
  /* ===============================
     START
  ================================ */
  fetchTasks();
</script>

  </body>
</html>
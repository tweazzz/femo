<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ß–∞—Ç</title>
  <link rel="stylesheet" href="/dist/style.css" />
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://unpkg.com/@lucide/web@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
      <div class="mb-10 px-6 py-7">
        <img src="/src/assets/images/logo.png" alt="Logo" class="h-5" />
      </div>

      <nav class="flex-1 px-4">
        <a href="/representatives/index.html" class="sidebar-link">
          <img src="/src/assets/images/index_noactive.svg" alt="–ì–ª–∞–≤–Ω–∞—è" class="mr-3 size-6" />
          –ì–ª–∞–≤–Ω–∞—è
        </a>
        <a href="/representatives/members.html" class="sidebar-link">
          <img src="/src/assets/images/users_noactive.svg" alt="–£—á–∞—Å—Ç–Ω–∏–∫–∏" class="mr-3 size-6" />
          –£—á–∞—Å—Ç–Ω–∏–∫–∏
        </a>
        <a href="/representatives/results.html" class="sidebar-link">
          <img src="/src/assets/images/ranking_noactive.svg" alt="–†–µ–∑—É–ª—å—Ç–∞—Ç—ã" class="mr-3 size-6" />
          –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
        </a>
        <a href="/representatives/chat.html" class="sidebar-link active">
          <img src="/src/assets/images/chat_active.svg" alt="–ß–∞—Ç" class="mr-3 size-6" />
          –ß–∞—Ç
        </a>
      </nav>

      <div class="p-4">
        <a href="/representatives/profile.html" class="sidebar-link">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="mr-3 size-6">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
          </svg>

          –ü—Ä–æ—Ñ–∏–ª—å
        </a>
      </div>
    </aside>

    <!-- Overlay -->
    <div id="overlay" class="fixed inset-0 z-20 hidden cursor-pointer bg-black/50 transition lg:hidden"
      onclick="toggleSidebar()"></div>

    <!-- Main Content -->
    <div class="flex flex-1 flex-col overflow-hidden">
      <!-- Top Bar -->
      <header class="border-gray-border border-b bg-white">
        <div class="flex items-center justify-between px-6 py-4">
          <div class="flex items-center">
            <button class="mr-4 cursor-pointer text-gray-600 hover:text-gray-900 lg:hidden" onclick="toggleSidebar()">
              <i data-lucide="menu" class="h-6 w-6"></i>
            </button>
            <h1 class="text-xl max-md:hidden">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ê–π–∂–∞–Ω üëã</h1>
          </div>
          <div class="flex items-center space-x-4">
            <button type="button" onclick="toggleModal('modalNotification')"
              class="text-orange-primary bg-orange-secondary cursor-pointer rounded-full p-1">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
              </svg>
            </button>
            <div class="flex items-center space-x-3">
                <img
                  id="user-avatar"
                  src=""
                  alt="Profile"
                  class="h-10 w-10 rounded-full"
                />
                <div>
                  <p id="user-name" class="font-bold"></p>
                  <p id="user-role" class="text-primary text-sm"></p>
                </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Dashboard Content -->
      <!-- –ì–ª–∞–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
      <main class="flex flex-1 overflow-hidden md:p-6">
        <!-- Chat Container -->
        <div class="border-default relative flex overflow-y-auto rounded-2xl w-full max-w-6xl mx-auto">
          <div
            class="flex max-md:absolute max-md:inset-0 z-10 max-md:w-full md:w-96 flex-col border-r border-gray-200 bg-white">
            <!-- Search -->
            <div class="p-4">
              <div class="relative">
                <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏" class="input-base border-default !pl-9" />
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="text-gray-primary absolute top-1/2 left-2.5 size-5 -translate-y-1/2">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                </svg>
              </div>
            </div>

            <!-- Chat Tabs -->
            <div class="px-4 pb-4">
              <div class="space-y-1">
                <!-- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫) -->
                <div id="administrators-list">
                  <!-- –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <!-- –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç -->
                <a href="#" data-tab="group" class="chat-tab flex w-full items-center justify-between rounded-lg p-3 text-left hover:bg-gray-50">
                  <div class="flex items-center gap-3">
                    <div class="flex-shrink-0">
                      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="24" cy="24" r="24" fill="#FEF6ED"/>
                        <path d="M29.9981 19.16C29.9381 19.15 29.8681 19.15 29.8081 19.16C28.4281 19.11 27.3281 17.98 27.3281 16.58C27.3281 15.15 28.4781 14 29.9081 14C31.3381 14 32.4881 15.16 32.4881 16.58C32.4781 17.98 31.3781 19.11 29.9981 19.16Z" stroke="#F4891E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M28.9675 26.4399C30.3375 26.6699 31.8475 26.4299 32.9075 25.7199C34.3175 24.7799 34.3175 23.2399 32.9075 22.2999C31.8375 21.5899 30.3075 21.3499 28.9375 21.5899" stroke="#F4891E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M17.9705 19.16C18.0305 19.15 18.1005 19.15 18.1605 19.16C19.5405 19.11 20.6405 17.98 20.6405 16.58C20.6405 15.15 19.4905 14 18.0605 14C16.6305 14 15.4805 15.16 15.4805 16.58C15.4905 17.98 16.5905 19.11 17.9705 19.16Z" stroke="#F4891E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19.0014 26.4399C17.6314 26.6699 16.1214 26.4299 15.0614 25.7199C13.6514 24.7799 13.6514 23.2399 15.0614 22.2999C16.1314 21.5899 17.6614 21.3499 19.0314 21.5899" stroke="#F4891E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M23.9981 26.63C23.9381 26.62 23.8681 26.62 23.8081 26.63C22.4281 26.58 21.3281 25.45 21.3281 24.05C21.3281 22.62 22.4781 21.47 23.9081 21.47C25.3381 21.47 26.4881 22.63 26.4881 24.05C26.4781 25.45 25.3781 26.59 23.9981 26.63Z" stroke="#F4891E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21.0888 29.7799C19.6788 30.7199 19.6788 32.2599 21.0888 33.1999C22.6888 34.2699 25.3087 34.2699 26.9087 33.1999C28.3187 32.2599 28.3187 30.7199 26.9087 29.7799C25.3187 28.7199 22.6888 28.7199 21.0888 29.7799Z" stroke="#F4891E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </div>
                    <div>
                      <p class="text-sm font-bold">–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç</p>
                      <p class="mt-1 text-xs text-gray-500">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–∞–π–ª, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞</p>
                    </div>
                  </div>
                  <div id="group-status-icon" class="flex items-center justify-center w-6 h-6 flex-shrink-0">
                    <!-- –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                  </div>
                </a>

                <!-- –û–±—ä—è–≤–ª–µ–Ω–∏—è -->
                <a href="#" data-tab="announcements" class="chat-tab active bg-gray-50 flex w-full items-center justify-between rounded-lg p-3 text-left hover:bg-gray-50">
                  <div class="flex items-center gap-3">
                    <div class="flex-shrink-0">
                      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="24" cy="24" r="24" fill="#ECF9F2"/>
                        <path d="M19 24C15 24 15 25.79 15 28V29C15 31.76 15 34 20 34H28C32 34 33 31.76 33 29V28C33 25.79 33 24 29 24C28 24 27.72 24.21 27.2 24.6L26.18 25.68C25 26.94 23 26.94 21.81 25.68L20.8 24.6C20.28 24.21 20 24 19 24Z" stroke="#0DB459" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M31 24V18C31 15.79 31 14 27 14H21C17 14 17 15.79 17 18V24" stroke="#0DB459" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22.5508 21.23H25.8808" stroke="#0DB459" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21.7188 18.23H26.7188" stroke="#0DB459" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </div>
                    <div>
                      <p class="text-sm font-bold">–û–±—ä—è–≤–ª–µ–Ω–∏—è</p>
                      <p class="mt-1 text-xs text-gray-500">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–∞–π–ª, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞</p>
                    </div>
                  </div>
                  <div id="announcements-status-icon" class="flex items-center justify-center w-6 h-6 flex-shrink-0">
                    <!-- –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                  </div>
                </a>
              </div>
            </div>
          </div>

          <!-- Chat Area -->
          <div class="flex flex-1 flex-col bg-white h-full max-w-4xl">
            <!-- Chat Header -->
            <div class="p-4">
              <div class="flex items-center justify-between">
                <div onclick="openChatMobile()" id="chat-header" class="flex items-center gap-2 text-lg font-bold">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="size-5 md:hidden">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
                  </svg>
                  <span>–û–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                </div>
              </div>
            </div>

                          <!-- Messages Container -->
              <div class="flex flex-1 flex-col min-h-0">
                <!-- Messages -->
                <div id="chat-content" class="flex-1 overflow-y-auto p-4">
                  <!-- Private Admin Chats (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ) -->
                  <div id="admin-chats-container">
                    <!-- –ß–∞—Ç—ã —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                  </div>
                  
                  <!-- Group Chat -->
                  <div id="group-chat" class="chat-content hidden flex flex-col gap-6 min-h-full">
                  <div class="chat-placeholder flex items-center justify-center flex-1 text-gray-400">
                    <div class="text-center">
                      <p class="text-base">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                    </div>
                  </div>
                </div>

                <!-- Announcements Chat (Default) -->
                <div id="announcements-chat" class="chat-content active flex flex-col gap-6 min-h-full">
                  <div class="chat-placeholder flex items-center justify-center flex-1 text-gray-400">
                    <div class="text-center">
                      <p class="text-base">–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Message Input for Group Chat Only -->
              <div id="group-chat-input" class="hidden bg-white p-4">
                <!-- Attached Files Area (hidden by default) -->
                <div id="attached-files" class="hidden mb-3">
                  <div id="attached-file-item" class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg border">
                    <!-- File info will be inserted here -->
                  </div>
                </div>

                <!-- Error Message (hidden by default) -->
                <div id="error-message" class="hidden mb-3 opacity-0 transition-opacity duration-300">
                  <div class="flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg">
                    <svg class="w-5 h-5 text-red-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"/>
                    </svg>
                    <span id="error-message-text" class="text-red-700 text-sm"></span>
                  </div>
                </div>

                <!-- Input Container -->
                <div id="message-input-container" class="rounded-xl border border-gray-200 px-4">
                  <div class="flex items-center gap-2 rounded-lg bg-white">
                    <button class="cursor-pointer p-2 text-gray-400 hover:text-gray-600" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">
                      <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none">
                        <path d="M12 4v16m8-8H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                      </svg>
                    </button>
                    <textarea placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="chatarea flex-1 resize-none border-0 bg-transparent py-3 px-0 text-sm focus:outline-none focus:ring-0" rows="1" oninput="auto_grow(this)"></textarea>
                    <button class="cursor-pointer p-2 text-orange-500 hover:text-orange-600" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>

    </div>

    <!-- –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è -->
    <div id="overlayModal" class="overlay fixed inset-0 z-20 hidden bg-black/50 transition"></div>

    <!-- –ü–æ–ø–∞–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="modalNotification" class="modal fixed top-18 z-30 hidden max-w-lg max-sm:inset-x-4 sm:right-10 sm:w-full">
      <div class="relative">
        <div class="flex flex-col space-y-4 rounded-3xl bg-white p-4 pt-6 text-base">
          <p class="text-xl font-bold">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</p>

          <!-- –°–µ–∫—Ü–∏—è —Å —Ç–∞–±–∞–º–∏ (–ø–æ—Ä—è–¥–æ–∫: –í—Å–µ - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - –ß–∞—Ç—ã - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã) -->
          <div class="tabs !mb-4 justify-between overflow-x-auto">
            <div class="tabs-link active flex cursor-pointer items-center gap-1" data-tab="all">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="size-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.310A8.967 8.967 0 0 1 18 9.750
                          V9A6 6 0 0 0 6 9v.750a8.967 8.967 0 0 1-2.312 6.022
                          c1.733.640 3.560 1.085 5.455 1.310m5.714 0a24.255 24.255 0 0 1-5.714 0
                          m5.714 0a3 3 0 1 1-5.714 0" />
                </svg>
              </span>
              –í—Å–µ
              <span class="count-msg">0</span>
            </div>
            <div class="tabs-link flex cursor-pointer items-center gap-1" data-tab="users">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="size-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.380 9.380 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952
                          4.125 4.125 0 0 0-7.533-2.493
                          M15 19.128v-.003c0-1.113-.285-2.160-.786-3.070
                          M15 19.128v.106A12.318 12.318 0 0 1 8.624 21
                          c-2.331 0-4.512-.645-6.374-1.766l-.001-.109
                          a6.375 6.375 0 0 1 11.964-3.070
                          M12 6.375a3.375 3.375 0 1 1-6.750 0a3.375 3.375 0 0 1 6.750 0
                          Z
                          M20.250 8.625a2.625 2.625 0 1 1-5.250 0
                          a2.625 2.625 0 0 1 5.250 0" />
                </svg>
              </span>
              –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
              <span class="count-msg">0</span>
            </div>
            <div class="tabs-link flex cursor-pointer items-center gap-1" data-tab="chats">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                  <path d="M3.505 2.365A41.369 41.369 0 0 1 9 2
                          c1.863 0 3.697.124 5.495.365
                          1.247.167 2.18 1.108 2.435 2.268
                          a4.45 4.45 0 0 0-.577-.069
                          43.141 43.141 0 0 0-4.706 0
                          C9.229 4.696 7.5 6.727 7.5 8.998
                          v2.240c0 1.413.670 2.735 1.760 3.562
                          l-2.980 2.980A.750.750 0 0 1 5 17.250
                          v-3.443c-.501-.048-1-.106-1.495-.172
                          C2.033 13.438 1 12.162 1 10.720V5.280
                          c0-1.441 1.033-2.717 2.505-2.914Z" />
                  <path d="M14 6c-.762 0-1.520.020-2.271.062
                          C10.157 6.148 9 7.472 9 8.998
                          v2.240c0 1.519 1.147 2.839 2.710 2.935
                          .214.013.428.024.642.034
                          .200.009.385.090.518.224l2.350 2.350
                          a.750.750 0 0 0 1.280-.531v-2.070
                          c1.453-.195 2.500-1.463 2.500-2.915
                          V8.998c0-1.526-1.157-2.850-2.729-2.936
                          A41.645 41.645 0 0 0 14 6Z" />
                </svg>
              </span>
              –ß–∞—Ç—ã
              <span class="count-msg">0</span>
            </div>
            <div class="tabs-link flex cursor-pointer items-center gap-1" data-tab="results">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="size-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4.260 10.147a60.438 60.438 0 0 0-.491 6.347
                          A48.620 48.620 0 0 1 12 20.904
                          a48.620 48.620 0 0 1 8.232-4.410
                          a60.460 60.460 0 0 0-.491-6.347
                          m-15.482 0a50.636 50.636 0 0 0-2.658-.813
                          A59.906 59.906 0 0 1 12 3.493
                          a59.903 59.903 0 0 1 10.399 5.840
                          c-.896.248-1.783.520-2.658.814
                          m-15.482 0A50.717 50.717 0 0 1 12 13.489
                          a50.702 50.702 0 0 1 7.740-3.342
                          M6.750 15a.750.750 0 1 0 0-1.500
                          a.750.750 0 0 0 0 1.500Z
                          m0 0v-3.675A55.378 55.378 0 0 1 12 8.443
                          m-7.007 11.550A5.981 5.981 0 0 0 6.750 15.750v-1.500" />
                </svg>
              </span>
              –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
              <span class="count-msg">0</span>
            </div>
          </div>

          <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
          <div class="tabs-content scrollbar max-h-[70vh] overflow-y-scroll pe-2">
            <div class="tabs-notification" data-tab="all"></div>
            <div class="tabs-notification" data-tab="users"></div>
            <div class="tabs-notification" data-tab="chats"></div>
            <div class="tabs-notification" data-tab="results"></div>
          </div>
        </div>

        <button class="absolute top-6 right-5 cursor-pointer" onclick="toggleModal('modalNotification')">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5">
            <path fill-rule="evenodd" d="M5.470 5.470a.750.750 0 0 1 1.060 0L12 10.940l5.470-5.470
                    a.750.750 0 1 1 1.060 1.060L13.060 12l5.470 5.470
                    a.750.750 0 1 1-1.060 1.060L12 13.060l-5.470 5.470
                    a.750.750 0 0 1-1.060-1.060L10.940 12 5.470 6.530
                    a.750.750 0 0 1 0-1.060Z" clip-rule="evenodd" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <script>
    lucide.createIcons()

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar')
      const overlay = document.getElementById('overlay')
      sidebar.classList.toggle('active')
      overlay.classList.toggle('hidden')
    }

    function toggleModal(modalId, show = null) {
      const modal = document.getElementById(modalId)
      const overlay = document.getElementById('overlayModal')

      // Determine visibility
      const shouldShow =
        show !== null ? show : modal.classList.contains('hidden')

      // Manage overlay
      overlay.classList.toggle('hidden', !shouldShow)

      // Toggle modal
      modal.classList.toggle('hidden', !shouldShow)

      // Close other modals
      document.querySelectorAll('.modal').forEach((m) => {
        if (m.id !== modalId) m.classList.add('hidden')
      })

      // Body scroll control
      document.body.style.overflow = shouldShow ? 'hidden' : 'auto'
    }

    function auto_grow(element) {
      element.style.height = '5px'
      element.style.height = element.scrollHeight + 'px'
    }

    document.addEventListener('DOMContentLoaded', function () {
      const tabs = document.querySelectorAll('.tabs-link')
      const notifications = document.querySelectorAll('.tabs-notification')

      // Add click event listeners to tabs
      tabs.forEach((tab) => {
        tab.addEventListener('click', function () {
          const tabType = this.dataset.tab

          // Remove active class from all tabs
          tabs.forEach((t) => t.classList.remove('active'))

          // Add active class to clicked tab
          this.classList.add('active')

          // Filter notifications
          notifications.forEach((notification) => {
            if (tabType === 'all' || notification.dataset.tab === tabType) {
              notification.style.display = 'flex'
            } else {
              notification.style.display = 'none'
            }
          })
        })
      })
    })

  </script>

  <script src="/auth.js" defer></script>
  <script src="/src/representatives/notification.js" defer></script>
  <script src="/src/representatives/chat.js" defer></script>
  <script>
    async function ensureUserAuthenticated() {
      let userData = localStorage.getItem('user')

      if (!userData) {
        console.warn(
          'user –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage. –ü—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–∏—Ç—å access_token...'
        )
        const newAccessToken = await refreshAccessToken()
        console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç refreshAccessToken:', newAccessToken)

        if (!newAccessToken) {
          console.warn(
            'refreshAccessToken –≤–µ—Ä–Ω—É–ª null. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ /login.html'
          )
          window.location.href = '/index.html'
          return null
        }

        userData = localStorage.getItem('user')
        if (!userData) {
          console.warn('user –≤—Å—ë –µ—â—ë –Ω–µ –Ω–∞–π–¥–µ–Ω –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞. –†–µ–¥–∏—Ä–µ–∫—Ç.')
          window.location.href = '/index.html'
          return null
        }
      }

      const user = JSON.parse(userData)

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å
      const role = user.profile?.role
      if (role !== 'representative') {
        console.warn(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ä–æ–ª—å—é "${role}" –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ. –†–µ–¥–∏—Ä–µ–∫—Ç.`)
        window.location.href = '/index.html'
        return null
      }

      return user
    }

    let participantProfile = null; 

    function renderUserInfo(profile) {
      const avatarEl = document.getElementById('user-avatar');
      const nameEl = document.getElementById('user-name');
      const roleEl = document.getElementById('user-role');
      const welcomeEl = document.querySelector('h1.text-xl');

      const defaultAvatar = '/src/assets/images/user_logo.jpg';
      const imgPath = profile?.image;

      let finalAvatar = defaultAvatar;
      if (imgPath && typeof imgPath === 'string') {
        finalAvatar = imgPath.startsWith('http')
          ? imgPath
          : `https://portal.gradients.academy${imgPath}`;
      }

      avatarEl.src = finalAvatar;
      nameEl.textContent = profile.full_name_ru || '';
      const firstName = profile.full_name_ru?.split(' ')[0] || '';
      welcomeEl.textContent = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${firstName} üëã`;

      const countryCode = profile.country?.code || '';
      roleEl.textContent = `–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å${countryCode ? ' ' + countryCode : ''}`;
    }
    async function loadRepresentativeProfile() {
  try {
    const res = await authorizedFetch('https://portal.gradients.academy/users/representative/profile/');
    if (!res.ok) throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è: ${res.status}`);

    const data = await res.json();

    // üëâ –û–±–Ω–æ–≤–ª—è–µ–º —à–∞–ø–∫—É
    renderUserInfo(data);

    // üëâ –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–æ—Ñ–∏–ª—è
    document.getElementById('rep-id').textContent = data.id ?? '‚Äî';
    document.getElementById('rep-email').textContent = data.email ?? '‚Äî';
    document.getElementById('rep-full-name-ru').textContent = data.full_name_ru ?? '‚Äî';
    document.getElementById('rep-full-name-en').textContent = data.full_name_en ?? '‚Äî';
    document.getElementById('rep-country').textContent = data.country?.name ?? '‚Äî';

    const previewEl = document.getElementById('imagePreview');
    const fileNameEl = document.getElementById('fileName');

    if (data.image) {
      const imageUrl = data.image.startsWith('http')
        ? data.image
        : `https://portal.gradients.academy${data.image}`;
      previewEl.src = imageUrl;
      fileNameEl.textContent = data.image.split('/').pop();
    } else {
      previewEl.src = '/src/assets/images/man.png';
      fileNameEl.textContent = '‚Äî';
    }

    await fillRepresentativeForm(data);
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è:', err);
  }
}
    document.addEventListener('DOMContentLoaded', async () => {
    const user = await ensureUserAuthenticated()
    if (!user) return

    renderUserInfo(user);
      
    try {
      await loadRepresentativeProfile();
    } catch (err) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:', err)
    }
  })
  </script>
</body>

</html>